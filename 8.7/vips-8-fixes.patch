This file is part of MXE. See LICENSE.md for licensing information.

Contains ad hoc patches for cross building.

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Kleis Auke Wolthuizen <info@kleisauke.nl>
Date: Wed, 15 Aug 2018 20:00:00 +0200
Subject: [PATCH 1/1] Also close file handles as soon as we can


diff --git a/libvips/foreign/jpeg2vips.c b/libvips/foreign/jpeg2vips.c
index 1111111..2222222 100644
--- a/libvips/foreign/jpeg2vips.c
+++ b/libvips/foreign/jpeg2vips.c
@@ -668,7 +668,7 @@ read_jpeg_generate( VipsRegion *or,
 	 * object, destroy as soon as we can. Safe to call many times. 
 	 */
 	if( jpeg->y_pos >= or->im->Ysize ) 
-		jpeg_destroy_decompress( &jpeg->cinfo );
+		(void) readjpeg_free( jpeg );
 
 	VIPS_GATE_STOP( "read_jpeg_generate: work" );
 
